var mapObject,directionsDisplay,directionsService=new google.maps.DirectionsService,initMaps=function(){var e='<i class="fa fa-cog fa-spin fa-lg"></i>',o='<i class="fa fa-location-arrow fa-lg"></i>',t=$("#startAddress");if("undefined"==typeof navigator.geolocation)return void $("#error").text("Your browser doesn't support the Geolocation API");directionsDisplay=new google.maps.DirectionsRenderer;var a={zoom:10,center:new google.maps.LatLng(-43.429944,172.705426),mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.DEFAULT},scaleControl:!1,mapTypeControl:!1};mapObject=new google.maps.Map(document.getElementById("map-canvas"),a),directionsDisplay.setMap(mapObject),directionsDisplay.setPanel(document.getElementById("directions-panel")),$("#geo-detect-link").click(function(a){a.preventDefault();var n=$(this);n.html(e),navigator.geolocation.getCurrentPosition(function(e){var a=new google.maps.Geocoder;a.geocode({location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude)},function(e,a){var r=e[0].formatted_address;a==google.maps.GeocoderStatus.OK?(t.val(r),calculateRoute(),n.html(o)):$("#error").append("Unable to retrieve your address<br />")})},function(e){$("#error").append("Error: "+e.message+"<br />")},{enableHighAccuracy:!0,timeout:1e4})}),$("#calculate-route").submit(function(e){e.preventDefault(),calculateRoute(t.val())})},calculateRoute=function(){var e="110 Heyders Road, Bottle Lake, Christchurch 8083, New Zealand",o=$("#startAddress").val(),t={origin:o,destination:e,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC};directionsService.route(t,function(e,o){o==google.maps.DirectionsStatus.OK?directionsDisplay.setDirections(e):$("#error").text("This address is invalid.")})};$(document).ready(function(){initMaps()});